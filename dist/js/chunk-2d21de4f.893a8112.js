(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21de4f"],{d2f1:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container py-5"},[r("SideCartPreview",{directives:[{name:"show",rawName:"v-show",value:t.showSideCart,expression:"showSideCart"}],attrs:{"initial-cart":t.cart},on:{clickDeleteItem:t.handleDeleteItem}}),r("ProductDetail",{attrs:{"initial-product":t.product},on:{clickAddToCart:t.handleAddToCart}})],1)},n=[],i=(r("96cf"),r("3b8d")),c=r("2fa3"),o=r("ee21"),s=r("cc17"),u=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("h1",{staticClass:"py-3 font-weight-bold"},[t._v(t._s(t.product.name))]),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-4 mb-5"},[r("div",{staticClass:"w-100"},[r("div",{staticStyle:{width:"100%","padding-bottom":"100%","background-position":"center","background-repeat":"no-repeat","background-size":"cover"},style:{"background-image":"url("+t.product.image+")"}})])]),r("div",{staticClass:"col-md-8"},[r("p",[t._v(t._s(t.product.description))]),r("hr"),r("span",{staticClass:"float-right text-secondary card-text text-truncate"},[t._v("原價$ "+t._s(t.product.origin_price)+" 元")]),r("h5",{staticClass:"card-text text-truncate font-weight-bold text-success"},[t._v("NT$ "+t._s(t.product.sell_price)+" 元")]),r("div",{staticClass:"addToCart text-right py-5"},[r("form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleAddToCart(e)}}},[0===t.product.stock_quantity?r("div",{staticClass:"input-group"},[r("button",{staticClass:"btn btn-secondary btn-block",attrs:{type:"button",disabled:""}},[t._v("商品已無庫存")])]):r("div",{staticClass:"input-group"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.productQuantity,expression:"productQuantity"}],staticClass:"form-control",attrs:{type:"number",name:"quantity",min:"1"},domProps:{value:t.productQuantity},on:{input:function(e){e.target.composing||(t.productQuantity=e.target.value)}}}),t._m(0)])])]),r("a",{staticClass:"text-primary",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("回前一頁")])])])])},d=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"input-group-append"},[r("button",{staticClass:"btn btn-danger px-5",attrs:{type:"submit"}},[t._v("加入購物車")])])}],p={props:{initialProduct:{type:Object,required:!0}},data:function(){return{productQuantity:1,product:this.initialProduct}},watch:{initialProduct:function(){this.product=this.initialProduct}},methods:{handleAddToCart:function(){console.log("加入商品數量",this.productQuantity),this.$emit("clickAddToCart",this.product.id,parseInt(this.productQuantity))}}},l=p,h=r("2877"),f=Object(h["a"])(l,u,d,!1,null,null,null),m=f.exports,v=r("bf4e"),b={components:{ProductDetail:m,SideCartPreview:v["a"]},data:function(){return{product:{},cart:{},showSideCart:!1}},watch:{"$route.params.productId":function(t){this.fetchProduct(t)}},created:function(){var t=this.$route.params.productId;this.fetchProduct(t)},mounted:function(){var t=this;this.$root.$on("toggleSideCart",function(){t.showSideCart=!t.showSideCart})},methods:{fetchProduct:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(e){var r,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r=this,t.next=4,o["a"].getProduct(e);case 4:if(a=t.sent,"OK"===a.statusText){t.next=7;break}throw new Error(a.statusText);case 7:r.product=a.data.product,r.cart=a.data.cart,r.$store.commit("setNavbarCartItemNumber",a.data.cart.items.length),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),c["Toast"].fire({type:"error",title:"無法取得單一商品資料，請稍後再試"});case 15:case"end":return t.stop()}},t,this,[[0,12]])}));function e(e){return t.apply(this,arguments)}return e}(),handleAddToCart:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(e,r){var a,n,i,o,u;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,a=this,n=a.product.stock_quantity,!(n<r)){t.next=5;break}return t.abrupt("return",c["Toast"].fire({type:"warning",title:"商品數量不足，目前剩餘 ".concat(n," 個，請重新輸入！")}));case 5:return t.next=7,s["a"].addToCart(e,r);case 7:if(i=t.sent,o=i.data,u=i.statusText,"OK"===u){t.next=12;break}throw new Error(u);case 12:void 0===o.product?(a.productSQIsEnough=!1,c["Toast"].fire({type:"warning",title:"抱歉，商品已無額外庫存囉！"})):c["Toast"].fire({type:"success",title:"商品成功加入購物車！"}),a.fetchProduct(e),t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](0),c["Toast"].fire({type:"error",title:"無法加入購物車，請稍後再試"});case 19:case"end":return t.stop()}},t,this,[[0,16]])}));function e(e,r){return t.apply(this,arguments)}return e}(),handleDeleteItem:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(e,r){var a,n,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a=this,n=a.$route.params.productId,t.next=5,o["a"].deleteItem(e,r);case 5:if(i=t.sent,s=i.statusText,"OK"===s){t.next=9;break}throw new Error(s);case 9:a.fetchProduct(n),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),c["Toast"].fire({type:"error",title:"無法刪除購物車商品，請稍後再試"});case 15:case"end":return t.stop()}},t,this,[[0,12]])}));function e(e,r){return t.apply(this,arguments)}return e}()}},w=b,g=Object(h["a"])(w,a,n,!1,null,null,null);e["default"]=g.exports}}]);
//# sourceMappingURL=chunk-2d21de4f.893a8112.js.map